ZOL.util=ZOL.util||{};ZOL.util.AJAX=function(){this.lang={HTTP_BUILDING_LINK:"",HTTP_SENDING:"",HTTP_LOADING:"",HTTP_DATA_IN_PROCESSED:"",HTTP_LOAD_FAILED:""};this.statusId=null;this.targetUrl="ooo";this.postData="";this.recvType="HTML";this.async=true;this.isCache=true;this._poll={};this._rewrite=true;this.callback=null;var a=this;this._msxmlVersion=["MSXML2.XMLHTTP","MSXML.XMLHTTP","Microsoft.XMLHTTP",];this.createXMLHttpRequest=function(){var c=false;if(window.XMLHttpRequest){c=new XMLHttpRequest()}else{if(window.ActiveXObject){for(i in this._msxmlVersion){try{c=new ActiveXObject(this._msxmlVersion[i]);if(c){return c}}catch(d){}}}}return c};var b=this.createXMLHttpRequest();this._processHandle=function(){if(a.statusId){a.statusId.style.display="block"}if(b.readyState==1&&a.statusId){a.lang.HTTP_BUILDING_LINK&&(a.statusId.innerHTML=a.lang.HTTP_BUILDING_LINK)}else{if(b.readyState==2&&a.statusId){a.lang.HTTP_SENDING&&(a.statusId.innerHTML=a.lang.HTTP_SENDING)}else{if(b.readyState==3&&a.statusId){a.lang.HTTP_LOADING&&(a.statusId.innerHTML=a.lang.HTTP_LOADING)}else{if(b.readyState==4){if(b.status==200){if(a.statusId){a.lang.HTTP_DATA_IN_PROCESSED&&(a.statusId.innerHTML=a.lang.HTTP_DATA_IN_PROCESSED)}if(a.recvType=="HTML"){var c=b.responseText}else{if(a.recvType=="XML"){var c=b.responseXML.lastChild.firstChild.nodeValue}}a._poll[a.targetUrl]=c;a.callback(c,a)}else{if(a.statusId){a.lang.HTTP_LOAD_FAILED&&(a.statusId.innerHTML=a.lang.HTTP_LOAD_FAILED)}}}}}}};this.get=function(d,c){this.targetUrl=d;this.callback=c;if(this._rewrite&&ZOL.env.getRewriteJsUrl){this.targetUrl=ZOL.env.getRewriteJsUrl(d)}if(this._poll[this.targetUrl]&&this.isCache){this.callback(this._poll[this.targetUrl],this);return true}b.onreadystatechange=(ZOL.browser.FIREFOX&&!this.async)?this._processHandle():this._processHandle;if(window.XMLHttpRequest){b.open("GET",this.targetUrl,this.async);b.send(null)}else{b.open("GET",this.targetUrl,this.async);b.send()}if(!this.async){b.onreadystatechange=ZOL.browser.FIREFOX?this._processHandle():this._processHandle}};this.post=function(e,c,d){this.targetUrl=e;this.postData=c;this.callback=d;if(this._rewrite&&ZOL.env.getRewriteJsUrl){this.targetUrl=ZOL.env.getRewriteJsUrl(e)}if(this._poll[this.targetUrl]&&this.isCache){this.callback(this._poll[this.targetUrl],this);return true}b.onreadystatechange=this._processHandle;b.open("POST",this.targetUrl,this.async);b.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=gbk");b.send(this.postData)};this.abort=function(){return b.abort()}};