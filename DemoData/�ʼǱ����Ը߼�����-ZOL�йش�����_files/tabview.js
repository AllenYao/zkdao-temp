ZOL.widget=ZOL.widget||{};ZOL.widget.TabView=function(a,j){var q=this;this.option={tagName:"a",defaultSel:"",activeCss:"sel",ignoreCss:"ignore",eventName:"onmouseover",requestUrl:"",rewrite:true,ajUrn:"",ajCache:{},ajCon:"",callback:null,Delay:0,autoPlay:0,ajLang:null};this.waitInterval=null;if(typeof j=="object"){for(var n in j){this.option[n]=j[n]}}this._doTab=function(e,t){var s=e;var u=s.getAttribute("rel");u=u?u:q.option.ajCon;var w=s.getAttribute("urn");if(!w){if(q.option.ajUrn&&q.option.ajUrn=="INNER"){w=this.innerHTML}else{w=q.option.ajUrn}}var v=ZOL.$(u);var m=s.parentNode.getElementsByTagName(q.option.tagName);var i=[];clearTimeout(q.waitInterval);q.waitInterval=setTimeout(function(){for(var A=0;A<m.length;A++){var C=m[A];if(C.className==q.option.ignoreCss){continue}var x=m[A].getAttribute("rel");var z=ZOL.$(x);i[A]=z;ZOL.removeClass(C,q.option.activeCss);z&&(z.style.display="none");if(s==m[A]){ZOL.addClass(s,q.option.activeCss);v&&(v.style.display="block");if(q.option.autoPlay&&t.autoPlayHd&&!q.auto){q._stop(t);s.onmouseout=function(){q._play(t)}}}}var D=function(){(typeof(q.option.callback)=="function")&&q.option.callback(s,v,m,i)};if(w){if(q.option.ajCache[w]==null){if(ZOL.util.AJAX){var y=new ZOL.util.AJAX();y._rewrite=q.option.rewrite;if(q.option.ajLang){y.statusId=v;y.lang=q.option.ajLang}var B=q.option.requestUrl+w;y.get(B,function(E){q.option.ajCache[w]=E;v.innerHTML=E;D()})}}else{v.innerHTML=q.option.ajCache[w];D()}}else{D()}},q.option.Delay)};this._play=function(i){clearInterval(i.autoPlayHd);var e=this;var m=function(){var t=ZOL.find(e.option.tagName,i);var s=null;ZOL.each(t,function(w,u){var v=" "+w.className+" ";if(v.indexOf(" "+e.option.activeCss+" ")>=0){s=u<t.length?t[u+1]:t[0]}});s=s||t[0];e.auto=true;e._doTab(s,i)};i.autoPlayHd=setInterval(m,e.option.autoPlay)};this._stop=function(e){clearInterval(e.autoPlayHd)};for(var g=0;g<a.length;g++){var d=ZOL.$(a[g]);if(!d){continue}var l=ZOL.find(this.option.tagName,d);var c=null;var h=function(){q.auto=false;q._doTab(this,d)};for(var f=0;f<l.length;f++){var p=l[f];if(p.className==this.option.ignoreCss){continue}var r=p.getAttribute("urn");var o=p.getAttribute("rel");o=o?o:this.option.ajCon;if(this.option.defaultSel&&(r==this.option.defaultSel||o==this.option.defaultSel)){c=p}var b=ZOL.$(o);b.tab=p;if(r&&r.indexOf("#default")>-1){this.option.ajCache[r]=b.innerHTML}var k=this.option.eventName;k=k.indexOf("on")==0?k.substr(2):k;ZOL.addEvent(p,k,h);if(this.option.autoPlay){ZOL.addEvent(b,k,function(){h.apply(this.tab)});b.onmouseout=function(){this.tab.onmouseout&&this.tab.onmouseout()}}}c&&c[q.option.eventName]();if(q.option.autoPlay){d.autoPlayHd=null;q._play(d)}}};